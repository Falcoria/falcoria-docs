
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../scan-configuration/">
      
      
        <link rel="next" href="../team-collaboration/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Deduplication Behavior - Falcoria Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deduplication-behavior" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Falcoria Documentation" class="md-header__button md-logo" aria-label="Falcoria Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Falcoria Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deduplication Behavior
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Falcoria Documentation" class="md-nav__button md-logo" aria-label="Falcoria Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Falcoria Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Falcoria
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/falcli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI (falcli)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/scanledger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ScanLedger
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Import Modes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Import Modes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../import-modes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../import-modes/insert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Insert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../import-modes/replace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Replace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../import-modes/update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Update
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../import-modes/append/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Append
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Use Cases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Use Cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-external-reports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import External Reports
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rescan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rescan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../update-enrichment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Update Enrichment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../port-sharding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Port Sharding (Evasion)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scan-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scan Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Deduplication Behavior
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Deduplication Behavior
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deduplication-during-scan-report-imports" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication During Scan Report Imports
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-deduplication-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Deduplication Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deduplication-during-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication During Scanning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deduplication During Scanning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-deduplication-of-user-provided-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      1. Deduplication of User-Provided Hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-deduplication-against-queued-targets" class="md-nav__link">
    <span class="md-ellipsis">
      2. Deduplication Against Queued Targets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deduplication-against-previously-scanned-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      3. Deduplication Against Previously Scanned Hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../team-collaboration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Team Collaboration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deduplication-during-scan-report-imports" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication During Scan Report Imports
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-deduplication-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Deduplication Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deduplication-during-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication During Scanning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deduplication During Scanning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-deduplication-of-user-provided-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      1. Deduplication of User-Provided Hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-deduplication-against-queued-targets" class="md-nav__link">
    <span class="md-ellipsis">
      2. Deduplication Against Queued Targets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deduplication-against-previously-scanned-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      3. Deduplication Against Previously Scanned Hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="deduplication-behavior">Deduplication Behavior<a class="headerlink" href="#deduplication-behavior" title="Permanent link">&para;</a></h1>
<p>Falcoria applies deduplication at multiple stages of the scanning workflow. This ensures efficient resource usage, consistent scan results, and seamless support for resuming interrupted scans. This document describes how deduplication works both during the import of external scan reports and during the scan phase itself.</p>
<hr />
<h2 id="deduplication-during-scan-report-imports">Deduplication During Scan Report Imports<a class="headerlink" href="#deduplication-during-scan-report-imports" title="Permanent link">&para;</a></h2>
<p>When importing external Nmap reports, Falcoria uses import modes to control how incoming data is merged with existing results. These modes prevent duplication of previously scanned ports, IPs, or entries that match known states.</p>
<p>The deduplication logic depends entirely on the selected import mode. For example:</p>
<ul>
<li><code>insert</code> will skip any existing entries</li>
<li><code>replace</code> will remove and overwrite previous data</li>
<li><code>update</code> only modifies ports that already exist</li>
</ul>
<p>To understand these behaviors in depth, see the following resources:</p>
<ul>
<li><a href="../import-external-reports/">Import External Reports Use Case</a></li>
<li><a href="../../import-modes/">Import Modes Overview</a></li>
</ul>
<hr />
<h2 id="why-deduplication-matters">Why Deduplication Matters<a class="headerlink" href="#why-deduplication-matters" title="Permanent link">&para;</a></h2>
<p>Falcoria’s deduplication mechanisms are critical for:</p>
<ul>
<li>Reducing scan duration by avoiding repeated work</li>
<li>Preventing duplicate entries in the project database</li>
<li>Minimizing network and system load</li>
<li>Enabling scan resumption without reconfiguration or manual filtering</li>
</ul>
<p>Once a host is scanned or queued, Falcoria will skip it on repeated execution of the same scan command. This allows the system to resume scans from where they stopped and prevents duplicate tasks from being created.</p>
<hr />
<h2 id="deduplication-during-scanning">Deduplication During Scanning<a class="headerlink" href="#deduplication-during-scanning" title="Permanent link">&para;</a></h2>
<p>Falcoria applies three layers of deduplication during the scan phase:</p>
<h3 id="1-deduplication-of-user-provided-hosts">1. Deduplication of User-Provided Hosts<a class="headerlink" href="#1-deduplication-of-user-provided-hosts" title="Permanent link">&para;</a></h3>
<p>If the user supplies a target file that contains duplicate entries, only unique hosts will be accepted. The deduplication occurs at the <a href="../../architecture/">Tasker</a> level before queueing begins.</p>
<p><strong>Example: Hosts file with duplicates</strong>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>hosts_with_duplicates.txt
<span class="m">159</span>.223.15.22
<span class="m">159</span>.223.15.22
<span class="m">188</span>.166.121.245
</code></pre></div></p>
<p><strong>Scan execution after input deduplication</strong>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>./falcli.py<span class="w"> </span>scan<span class="w"> </span>start<span class="w"> </span>--targets-file<span class="w"> </span>hosts_with_duplicates.txt
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Scan<span class="w"> </span>targets<span class="w"> </span>sent<span class="w"> </span><span class="k">for</span><span class="w"> </span>project<span class="w"> </span>4e0d5a24-791d-4abb-a1fd-212f738b48b8.
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Sent<span class="w"> </span>to<span class="w"> </span>scan:
<span class="w">  </span>-<span class="w"> </span><span class="m">159</span>.223.15.22
<span class="w">  </span>-<span class="w"> </span><span class="m">188</span>.166.121.245
</code></pre></div></p>
<hr />
<h3 id="2-deduplication-against-queued-targets">2. Deduplication Against Queued Targets<a class="headerlink" href="#2-deduplication-against-queued-targets" title="Permanent link">&para;</a></h3>
<p>If a host is already queued for scanning and the same target is submitted again, Falcoria will reject it without duplication. This prevents redundant load and preserves system efficiency.</p>
<p><strong>Initial scan submission</strong>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>./falcli.py<span class="w"> </span>scan<span class="w"> </span>start<span class="w"> </span>--targets-file<span class="w"> </span>hosts.txt
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Scan<span class="w"> </span>targets<span class="w"> </span>sent<span class="w"> </span><span class="k">for</span><span class="w"> </span>project<span class="w"> </span>4e0d5a24-791d-4abb-a1fd-212f738b48b8.
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Sent<span class="w"> </span>to<span class="w"> </span>scan:
<span class="w">  </span>-<span class="w"> </span><span class="m">188</span>.166.121.245
<span class="w">  </span>-<span class="w"> </span><span class="m">128</span>.199.62.51
<span class="w">  </span>-<span class="w"> </span><span class="m">159</span>.223.15.22
<span class="w">  </span>-<span class="w"> </span><span class="m">134</span>.209.203.62
</code></pre></div></p>
<p><strong>Verifying that targets are already in the scan queue</strong>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>./falcli.py<span class="w"> </span>scan<span class="w"> </span>status
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Scan<span class="w"> </span>status<span class="w"> </span><span class="k">for</span><span class="w"> </span>project<span class="w"> </span>4e0d5a24-791d-4abb-a1fd-212f738b48b8:<span class="w"> </span><span class="m">4</span>
</code></pre></div></p>
<p><strong>Re-submitting the same targets</strong>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>./falcli.py<span class="w"> </span>scan<span class="w"> </span>start<span class="w"> </span>--targets-file<span class="w"> </span>hosts.txt
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Scan<span class="w"> </span>targets<span class="w"> </span>sent<span class="w"> </span><span class="k">for</span><span class="w"> </span>project<span class="w"> </span>4e0d5a24-791d-4abb-a1fd-212f738b48b8.
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>targets<span class="w"> </span>were<span class="w"> </span>accepted<span class="w"> </span><span class="k">for</span><span class="w"> </span>scanning.
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Rejected<span class="w"> </span>targets:
<span class="w">  </span>-<span class="w"> </span><span class="m">188</span>.166.121.245
<span class="w">  </span>-<span class="w"> </span><span class="m">128</span>.199.62.51
<span class="w">  </span>-<span class="w"> </span><span class="m">159</span>.223.15.22
<span class="w">  </span>-<span class="w"> </span><span class="m">134</span>.209.203.62
</code></pre></div></p>
<hr />
<h3 id="3-deduplication-against-previously-scanned-hosts">3. Deduplication Against Previously Scanned Hosts<a class="headerlink" href="#3-deduplication-against-previously-scanned-hosts" title="Permanent link">&para;</a></h3>
<p>Falcoria checks the project’s scan history in ScanLedger. If a host has already been scanned and recorded in the database, it will not be accepted for scanning again using the same command and project context.</p>
<p><strong>Database contents</strong>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>./falcli.py<span class="w"> </span>project<span class="w"> </span>ips<span class="w"> </span>list
IP<span class="w">               </span>PORT_COUNT
<span class="m">128</span>.199.62.51<span class="w">    </span><span class="m">6</span><span class="w">         </span>
<span class="m">134</span>.209.203.62<span class="w">   </span><span class="m">6</span><span class="w">         </span>
<span class="m">159</span>.223.15.22<span class="w">    </span><span class="m">6</span><span class="w">         </span>
<span class="m">188</span>.166.121.245<span class="w">  </span><span class="m">8</span><span class="w">         </span>
</code></pre></div></p>
<p><strong>Attempting to rescan the same IPs</strong>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>hosts.txt
<span class="m">134</span>.209.203.62
<span class="m">159</span>.223.15.22
<span class="m">188</span>.166.121.245
<span class="m">128</span>.199.62.51

$<span class="w"> </span>./falcli.py<span class="w"> </span>scan<span class="w"> </span>start<span class="w"> </span>--targets-file<span class="w"> </span>hosts.txt
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Scan<span class="w"> </span>targets<span class="w"> </span>sent<span class="w"> </span><span class="k">for</span><span class="w"> </span>project<span class="w"> </span>4e0d5a24-791d-4abb-a1fd-212f738b48b8.
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>targets<span class="w"> </span>were<span class="w"> </span>accepted<span class="w"> </span><span class="k">for</span><span class="w"> </span>scanning.
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Rejected<span class="w"> </span>targets:
<span class="w">  </span>-<span class="w"> </span><span class="m">188</span>.166.121.245
<span class="w">  </span>-<span class="w"> </span><span class="m">128</span>.199.62.51
<span class="w">  </span>-<span class="w"> </span><span class="m">159</span>.223.15.22
<span class="w">  </span>-<span class="w"> </span><span class="m">134</span>.209.203.62
</code></pre></div></p>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>Falcoria enforces deduplication at the following stages:</p>
<ul>
<li>When importing external reports</li>
<li>When parsing user input</li>
<li>When filtering against the current queue</li>
<li>When validating against the project’s historical records</li>
</ul>
<p>These mechanisms work together to prevent waste, accelerate scans, and allow users to safely repeat scan commands without unintended repetition. This makes Falcoria suitable for large-scale, iterative scanning across complex infrastructures.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.sections", "navigation.instant", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>